<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pembayaran - <%= shopName %></title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1><%= shopName %></h1>
      <p>Pembayaran Server</p>
    </header>

    <div class="payment-container">
      <h2>Pembayaran <%= order.product.name %></h2>
      <p>Harga: Rp<%= order.product.price.toLocaleString('id-ID') %></p>
      <p>Email: <%= order.email %></p>
      
      <div class="qris-container">
        <h3>Scan QRIS untuk Pembayaran</h3>
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=<%= order.paymentData.qris_raw %>" alt="QRIS Code">
        <p>Status: <span id="payment-status"><%= order.status %></span></p>
      </div>

      <p>Setelah pembayaran berhasil, server akan dibuat otomatis dalam 1-5 menit.</p>
      <a href="/">Kembali ke Beranda</a>
    </div>

    <footer>
      <p>&copy; 2023 <%= shopName %>. All rights reserved.</p>
    </footer>
  </div>

  <script>
    // Polling untuk cek status pembayaran
    setInterval(async () => {
      try {
        const response = await fetch(`/success/<%= order.paymentData.custom_id %>`);
        if (response.ok) {
          window.location.href = `/success/<%= order.paymentData.custom_id %>`;
        }
      } catch (error) {
        console.error('Error checking payment status:', error);
      }
    }, 5000); // Cek setiap 5 detik
  </script>
</body>
</html>